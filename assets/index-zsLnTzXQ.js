var Y=Object.defineProperty;var D=(n,e,r)=>e in n?Y(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r;var u=(n,e,r)=>(D(n,typeof e!="symbol"?e+"":e,r),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(t){if(t.ep)return;t.ep=!0;const o=r(t);fetch(t.href,o)}})();class f{static byId(e){return document.getElementById(e)}static byClass(e){return document.querySelector(e)}}class l{constructor(e,r,s){u(this,"element");typeof e=="string"?this.element=document.createElement(e):this.element=e,r&&(this.element.id=r),s&&s.split(" ").forEach(o=>{this.element.classList.add(o)})}build(){return this.element}setClass(e){return e&&e.split(" ").forEach(s=>{this.element.classList.add(s)}),this}removeClass(e){return e&&e.split(" ").forEach(s=>{this.element.classList.remove(s)}),this}setAttribute(e,r){return this.element.setAttribute(e,r),this}}class d{constructor(e){u(this,"length");u(this,"sunk");u(this,"hits");this.length=e,this.hits=0,this.sunk=!1}hit(){this.hits++,this.hits>=this.length&&(this.sunk=!0)}get isSunk(){return this.sunk}get Length(){return this.length}get totalHit(){return this.hits}}let B=!1,z=!1,R=!0,C;function P(n,e,r){const s=new l("div",`${r}-board-container`).setClass("border-solid border-green-700 border-2 rounded-lg flex flex-col p-1 shadow-lg shadow-sky-300").build();for(let t=0;t<n;t++){const o=new l("div",`${r}-row-container`).setClass("flex").build();for(let i=0;i<e;i++){const a=new l("div",`${r}-cell`).setAttribute("data-x",`${t}`).setAttribute("data-y",`${i}`).setClass("p-2 border-solid border-2 border-black bg-green-600 w-10 h-10").build();o.appendChild(a)}s.appendChild(o)}return s}function F(n,e,r){n.querySelectorAll(`#${e}-cell`).forEach(t=>{t.addEventListener("click",o=>{k(o,r)}),t.addEventListener("dblclick",o=>{k(o,r)}),t.addEventListener("mousedown",o=>{B=!0,k(o,r)}),t.addEventListener("mouseup",()=>{B=!1,C=null}),t.addEventListener("mousemove",o=>{k(o,r)}),n.addEventListener("mouseleave",()=>{B=!1,C=null})})}function q(n){n!==void 0?R=n:z=!z}function k(n,e){const r=n.target;if(B&&z||n.type==="click"){const s=Number(r.getAttribute("data-x")),t=Number(r.getAttribute("data-y"));e&&!((e==null?void 0:e.getBoard[s][t])instanceof d)&&e.shipCounts()<5&&W(s,t,r,e)}}function W(n,e,r,s){if(s&&!(s.getBoard[n][e]instanceof d)){if(C||(C=new d(1)),s.shipCounts(C)>4)return;s==null||s.placeShip([n,e],1,"horizontal",C),r.classList.add("bg-sky-600")}}function K(n){const e=f.byId("computer-board-container");e&&e.querySelectorAll("#computer-cell").forEach(s=>{s.addEventListener("click",t=>T(t,n)),s.classList.add("hover:bg-[url('./scope.svg')]")})}function T(n,e){const r=n.target;if(R&&r.getAttribute("clicked")!=="true"){const s=e.Board,t=n.target,o=Number(t.getAttribute("data-x")),i=Number(t.getAttribute("data-y"));e.BoardManager.receiveAttack([o,i]),s[o][i]instanceof d?t.classList.add("bg-red-600"):t.classList.add("bg-white"),X(o,i,"computer"),setTimeout(()=>{re()},500)}}function V(n){return n?!(n.value.length<=0):!1}class S{constructor(e){u(this,"grid");u(this,"board");u(this,"totalShots");u(this,"missedShotsCoor");u(this,"missedShotsCount");this.grid=10,e?this.board=e:this.board=this.generateBoard(this.grid,0),this.totalShots=0,this.missedShotsCoor=[],this.missedShotsCount=0}generateBoard(e,r){return Array.from({length:e}).map(()=>Array.from({length:e}).fill(r))}set Board(e){this.board=e}get getBoard(){return this.board}setMark(e,r){this.board[e][r]=1e4}get missedShots(){return{missedShotsCoor:this.missedShotsCoor,missedShotsCount:this.missedShotsCount}}get GameOver(){return this.board.every(e=>e.every(r=>!(r instanceof d&&r.isSunk!==!0)))}getRandom(){var t;let e=!1,r=0,s=0;for(;!e;)if(r=Math.floor(Math.random()*10),s=Math.floor(Math.random()*10),((t=M(r,s))==null?void 0:t.getAttribute("clicked"))===null)return e=!0,{x:r,y:s};if(e)return{x:r,y:s}}isClicked(e,r,s="player"){const t=M(e,r,s);return!(t&&t.getAttribute("clicked")===null)}checkHit(e,r){return this.board[e][r]instanceof d?this.board[e][r].totalHit:!1}placeShip([e,r],s,t,o){const i=this.board.length,a=this.board[0].length;let c;if(e<0||r<0||t==="horizontal"&&r+s>a||t==="vertical"&&e+s>i)throw new Error("Placement coordinates are out of bound");if(o?c=o:c=new d(s),t==="horizontal"){for(let m=0;m<s;m++)this.board[e][r+m]=c;return!0}else if(t==="vertical"){for(let m=0;m<s;m++)this.board[e+m][r]=c;return!0}else throw new Error('Invalid orientation. Use "horizontal" or "vertical".')}receiveAttack([e,r]){return this.totalShots++,this.board[e][r]instanceof d?(this.board[e][r].hit(),!0):(this.missedShotsCount++,this.missedShotsCoor.push([e,r]),!1)}randomize(){let e=5;for(;e>0;){const r=Math.floor(Math.random()*3)+2,s=Math.floor(Math.random()*this.board.length),t=Math.floor(Math.random()*this.board.length),o=Math.random()<.5?"horizontal":"vertical";let i=!0;for(let a=s-1;a<=s+1;a++){for(let c=t-1;c<=t+1;c++)if(a>=0&&a<this.board.length&&c>=0&&c<this.board.length&&this.board[a][c]!==0){i=!1;break}if(!i)break}if(i)try{this.placeShip([s,t],r,o),e--}catch{continue}}return this.board}newBoard(){return this.board=this.generateBoard(10,0),this.board}shipCounts(e){const r=new Set;let s=0;return this.board.forEach(t=>{t.forEach(o=>{!e&&o instanceof d&&!o.isSunk?r.add(o):e&&o===e&&s++})}),e?s:r.size}}class O{constructor(e){u(this,"name");u(this,"board");this.name=e,this.board=new S}get Board(){return this.board.getBoard}set Board(e){this.board.Board=e}get BoardManager(){return this.board}get getName(){return this.name?this.name:null}}let g,x,E,L;function j(n){g=n,x=P(10,10,"player"),F(x,"player",g.BoardManager),L=new l("dialog","bulid-ship-container").setClass("backdrop:backdrop-blur-lg p-4 bg-slate-800 rounded-lg").build();const e=new l("div","dialog-container").setClass("flex flex-col gap-4 justify-center items-center font-sedanSC text-green-400").build(),r=new l("h3","dialog-title").setClass("text-3xl").build();r.textContent="Major, place your ships on the radar!",E=new l("span","dialog-message").build();const s=new l("div","dialog-buttons-container").setClass("flex gap-2 child:p-3 child-hover:text-sky-600 child-active:translate-y-1").build(),t=new l("button","randomize-button").build();t.textContent="Random";const o=new l("button","confirm-button").build();o.textContent="Confirm";const i=new l("button","reset-button").build();return i.textContent="Reset",s.appendChild(t),s.appendChild(o),s.appendChild(i),e.appendChild(r),e.appendChild(E),e.appendChild(x),e.appendChild(s),L.appendChild(e),t.addEventListener("click",J),i.addEventListener("click",Z),o.addEventListener("click",Q),{dialog:L,playersBoard:x}}function J(){const n=new S(g.Board).newBoard(),e=new S(n).randomize();g.Board=e,G(e)}function G(n){document.querySelectorAll("#player-row-container").forEach(r=>{r.querySelectorAll("#player-cell").forEach(t=>{const o=Number(t.getAttribute("data-x")),i=Number(t.getAttribute("data-y"));g.Board&&n[o][i]instanceof d?t.classList.contains("bg-sky-600")||t.classList.add("bg-sky-600"):t.classList.remove("bg-sky-600")})})}function Q(){const n=new S(g.Board).shipCounts();n<5&&(E.textContent="Ship size is less than 5"),n>5&&(E.textContent="Ship size is more than 5"),n===5&&(q(),G(g.Board),ee(),L.close())}function Z(){const n=new S(g.Board).newBoard();g.Board=n,document.querySelectorAll("#player-row-container").forEach(r=>{r.querySelectorAll("#player-cell").forEach(t=>{t.classList.contains("bg-sky-600")&&t.classList.remove("bg-sky-600")})}),G(n)}let p,v,b;const w=f.byId("next");w==null||w.addEventListener("click",n=>A(n));const h=f.byId("player-name-input");h==null||h.addEventListener("keydown",n=>{n.key==="Enter"&&A&&A(n)});function A(n){var s;const e=f.byId("build-ship-wrapper");if(n.type==="keydown"&&((s=n.target)==null||s.removeEventListener("keydown",A)),!V(h)){const t=f.byId("player-name-input-label");t==null||t.classList.add("text-red-400");const o=new l(h).setClass("ring-2 ring-red-500");setTimeout(()=>{t==null||t.classList.remove("text-red-400"),o.removeClass("ring-2 ring-red-500")},2e3);return}const r=f.byId("player-board-title");if(r&&(h!=null&&h.value?r.textContent=h.value:r.textContent="Player"),q(),p=new O(h==null?void 0:h.value),b=new O("computer"),b.BoardManager.randomize(),e){const t=f.byId("before-game");t&&(t.style.display="none");const o=f.byId("during-game");o&&(o.style.display="block"),v=j(p),e.appendChild(v.dialog),v.dialog.inert=!0,v.dialog.showModal(),v.dialog.inert=!1,w&&(w.style.display="none")}}const I=f.byId("player");I==null||I.appendChild(P(10,10,"player"));const N=f.byId("computer"),_=P(10,10,"computer");N==null||N.appendChild(_);function ee(){H(),U(),K(b)}function H(){const n=f.byId("ships-remaining-player"),e=f.byId("ships-remaining-computer");n&&(n.textContent=String(p.BoardManager.shipCounts())),e&&(e.textContent=String(b.BoardManager.shipCounts()))}function U(n){q(!0),te(),H(),p.BoardManager.GameOver?$("computer"):b.BoardManager.GameOver&&$("player")}function te(){const n=document.querySelector("#total-missed-player"),e=document.querySelector("#total-missed-computer"),r=p.BoardManager.missedShots.missedShotsCount,s=b.BoardManager.missedShots.missedShotsCount;n.textContent=String(s),e.textContent=String(r)}const y={x:void 0,y:void 0};function re(){const n=b.BoardManager.getRandom(),e=n==null?void 0:n.x,r=n==null?void 0:n.y;let s=e,t=r;se(y)&&(s=y.x,t=y.y);let o;s!==void 0&&t!==void 0&&(o=M(s,t)),ne(s,t),p.BoardManager.receiveAttack([s,t]),p.Board[s][t]instanceof d?o==null||o.classList.replace("bg-sky-600","bg-red-600"):(o==null?void 0:o.getAttribute("clicked"))!=="true"&&(o==null||o.classList.add("bg-white")),X(s,t),U()}function se(n){return typeof n.x=="number"&&typeof n.y=="number"}function M(n,e,r="player"){const s=document.querySelectorAll(`#${r}-cell`);for(const t of s){const o=t.getAttribute("data-x"),i=t.getAttribute("data-y");if(o===String(n)&&i===String(e))return t}}function X(n,e,r="player"){const s=M(n,e,r);s&&(s.setAttribute("clicked","true"),s.removeEventListener("click",t=>T(t,b)))}function $(n="player"){const e=new l("dialog","winner-dialog").setClass("p-32 backdrop:backdrop-blur-3xl text-3xl font-sedanSC text-green-600 bg-gray-900 outline-none rounded-xl text-center flex flex-col gap-4").build(),r=new l("h4").build();e.appendChild(r),p&&p.getName!==void 0?r.textContent=n==="player"?`${p.getName} wins!`:"Computer wins! Cry!":r.textContent="Something's messed up!";const s=new l("button","reload").setClass("p-1 rounded-md hover:bg-slate-50 hover:text-blue-800 active:translate-y-2 bg-blue-500 text-white").build();s.addEventListener("click",()=>{location.reload()}),s.textContent="Reload",e.appendChild(s),document.body.appendChild(e),e.showModal()}function ne(n,e,r="player"){const s=r==="player"?p.BoardManager:b.BoardManager,t=[{x:n+1,y:e},{x:n-1,y:e},{x:n,y:e+1},{x:n,y:e-1}];for(const o of t){const i=o.x,a=o.y;if(i>=0&&i<10&&a>=0&&a<10){const c=s.isClicked(i,a),m=s.getBoard[n][e];if(s.getBoard[i][a]instanceof d&&c===!1&&m instanceof d){y.x=i,y.y=a;return}}y.x=void 0,y.y=void 0}}
